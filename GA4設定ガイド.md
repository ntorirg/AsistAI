# Google Analytics 4 (GA4) 設定ガイド

## 1. イベントの確認と設定

### 現在実装されているイベント
- `form_start` - フォーム入力開始
- `form_submit` - フォーム送信開始
- `form_success` - 送信成功
- `form_error` - 送信エラー

### GA4での設定手順

#### 1. イベントの確認
1. **Google Analytics**にアクセス
2. **管理** → **プロパティ設定** → **イベント**
3. 実装されたイベントが自動的に表示されることを確認

#### 2. カスタムイベントの作成（推奨）
1. **管理** → **プロパティ設定** → **イベント** → **イベントを作成**
2. 以下のイベントを作成：

**フォーム開始イベント**
- イベント名: `form_start`
- パラメータ: `form_name`, `form_location`

**フォーム送信イベント**
- イベント名: `form_submit`
- パラメータ: `form_name`, `form_location`

**フォーム成功イベント**
- イベント名: `form_success`
- パラメータ: `form_name`, `form_location`

**フォームエラーイベント**
- イベント名: `form_error`
- パラメータ: `form_name`, `form_location`

#### 3. コンバージョンイベントの設定
1. **管理** → **プロパティ設定** → **イベント** → **コンバージョン**
2. 以下のイベントをコンバージョンとしてマーク：
   - `form_success` - 登録完了

#### 4. カスタムレポートの作成
1. **探索** → **新しい探索**
2. 以下のレポートを作成：

**フォーム分析レポート**
- ディメンション: イベント名、フォーム名
- 指標: イベント数、ユニークユーザー数
- フィルター: イベント名 = form_start, form_submit, form_success

**コンバージョンファネル**
- ステップ1: form_start
- ステップ2: form_submit
- ステップ3: form_success

## 2. 目標設定

### 目標の作成
1. **管理** → **プロパティ設定** → **目標**
2. 以下の目標を作成：

**登録完了目標**
- 目標名: "事前登録完了"
- 目標タイプ: イベント
- イベント名: form_success
- 条件: form_name に "heroRegistrationForm" または "bottomRegistrationForm" が含まれる

## 3. オーディエンス設定

### オーディエンスの作成
1. **管理** → **プロパティ設定** → **オーディエンス**
2. 以下のオーディエンスを作成：

**フォーム開始ユーザー**
- 条件: form_start イベントを発生させたユーザー

**登録完了ユーザー**
- 条件: form_success イベントを発生させたユーザー

**フォーム離脱ユーザー**
- 条件: form_start は発生したが form_success が発生していないユーザー

## 4. アラート設定

### アラートの作成
1. **管理** → **プロパティ設定** → **アラート**
2. 以下のアラートを作成：

**登録数急増アラート**
- 条件: form_success イベント数が前日比で50%以上増加

**フォーム離脱率アラート**
- 条件: form_start から form_success へのコンバージョン率が20%以下

## 5. データ検証

### リアルタイムでの確認
1. **リアルタイム** → **イベント**
2. フォーム操作時にイベントが正しく送信されることを確認

### デバッグモードでの確認
1. **管理** → **プロパティ設定** → **データストリーム**
2. **デバッグモード**を有効化
3. 実際にフォームを操作してイベントを確認

## 6. プライバシー設定

### データ保持期間
1. **管理** → **プロパティ設定** → **データ設定** → **データ保持**
2. イベントデータの保持期間を設定（推奨: 26ヶ月）

### ユーザー削除要求
1. **管理** → **プロパティ設定** → **データ設定** → **ユーザー削除要求**
2. ユーザー削除要求の処理方法を設定 